<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>OhmGo - Electronics Components</title>
  <style>
    /* ===== Reset & Base ===== */
    * { margin:0; padding:0; box-sizing:border-box; font-family: Arial, sans-serif; }
    body { background:#f9f9f9; color:#333; line-height:1.5; padding-bottom:60px; }

    /* Header */
    header { background:#004d99; color:white; padding:20px; text-align:center; position:sticky; top:0; z-index:20; }
    header h1 { margin-bottom:6px; }
    nav ul { list-style:none; display:flex; justify-content:center; gap:20px; }
    nav a { color:white; text-decoration:none; font-weight:700; }
    nav a:hover { text-decoration:underline; }

    main { padding:20px; max-width:1200px; margin:0 auto; }

    section { margin-bottom:40px; }
    section h2 { color:#004d99; margin-bottom:15px; }

    #new-product-form { margin-bottom:18px; display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    #new-product-form input[type="text"], #new-product-form input[type="number"] { padding:8px; border:1px solid #ccc; border-radius:6px; }
    #new-product-form button { padding:8px 12px; background:#28a745; color:white; border:none; border-radius:6px; cursor:pointer; }

    .product-container { display:grid; grid-template-columns:repeat(auto-fill, minmax(180px,1fr)); gap:15px; }

    .product-card { border:1px solid #ccc; border-radius:8px; background:white; padding:10px; text-align:center; display:flex; flex-direction:column; transition:transform .18s,box-shadow .18s; }
    .product-card:hover { transform:translateY(-4px); box-shadow:0 6px 18px rgba(0,0,0,0.08); }
    .product-card img { width:150px; height:150px; object-fit:contain; margin:0 auto 10px; cursor:pointer; }
    .product-card h3 { font-size:1rem; margin-bottom:8px; flex-grow:1; }
    .product-card p { margin-bottom:8px; font-weight:700; }

    .product-card button { padding:6px 8px; border:none; border-radius:6px; background:#004d99; color:white; cursor:pointer; margin:4px 0; }
    .product-card button.small { padding:5px 8px; font-size:0.9rem; }

    #cart-items { border:1px solid #ccc; padding:10px; border-radius:8px; background:#f1f1f1; margin-bottom:10px; min-height:40px; }
    .cart-item { display:flex; justify-content:space-between; gap:8px; margin-bottom:6px; align-items:center; }
    .cart-item button { background:red; color:white; border:none; padding:4px 6px; border-radius:6px; cursor:pointer; }

    #continue-btn, #whatsapp-checkout button, #export-overrides { padding:8px 12px; border:none; border-radius:6px; background:#28a745; color:white; cursor:pointer; margin-top:8px; }
    #continue-btn:hover, #whatsapp-checkout button:hover, #export-overrides:hover { background:#1e7e34; }

    #backToTopBtn { display:none; position:fixed; bottom:30px; right:30px; z-index:99; font-size:18px; border:none; padding:10px 14px; border-radius:8px; background:#004d99; color:white; cursor:pointer; }
    #backToTopBtn:hover { background:#003366; }

    footer { text-align:center; padding:12px 0; background:#eee; color:#666; margin-top:20px; border-top:1px solid #ddd; }

    @media (max-width:600px) {
      #new-product-form { flex-direction:column; align-items:stretch; }
      #new-product-form input, #new-product-form button { width:100%; }
      .product-card img { width:120px; height:120px; }
    }

    /* small helper */
    .muted { color:#666; font-size:0.9rem; }
  </style>
</head>
<body>

  <header>
    <h1>OhmGo</h1>
    <nav>
      <ul>
        <li><a href="#products">Products</a></li>
        <li><a href="#cart">Cart (<span id="cart-count">0</span>)</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <section id="products">
      <h2>Products</h2>

      <div id="new-product-form">
        <input type="text" id="newProductName" placeholder="Product name (e.g. Arduino UNO R3)">
        <input type="number" id="newProductPrice" placeholder="Price (₹)" min="1">
        <input type="text" id="newProductImageUrl" placeholder="Image URL (optional)">
        <button type="button" id="addProductBtn">Add Product</button>
        <button type="button" id="exportOverridesBtn" title="Download JSON of current image overrides" style="background:#007bff;">Export Overrides</button>
      </div>

      <input type="text" id="search" placeholder="Search Products…" style="padding:8px;border-radius:6px;border:1px solid #ccc;width:100%;margin-bottom:12px;">
      <div id="product-container" class="product-container"></div>
    </section>

    <section id="cart">
      <h2>Cart</h2>
      <div id="cart-items"><p class="muted">Your cart is empty.</p></div>
      <p id="total-price"></p>
      <button id="continue-btn" style="display:none;" onclick="showWhatsAppCheckout()">Continue</button>
      <div id="whatsapp-checkout" style="display:none;">
        <button onclick="checkoutWhatsApp()">Checkout via WhatsApp</button>
      </div>
    </section>

    <section id="contact">
      <h2>Contact Us</h2>
      <p>Email: <a href="mailto:ohmgoelectronics@gmail.com">ohmgoelectronics@gmail.com</a></p>
      <p>Instagram: <a href="https://www.instagram.com/ohmgo.in" target="_blank">@ohmgo.in</a></p>
      <p>WhatsApp: <a href="https://wa.me/919010532390" target="_blank">+91 9010532390</a></p>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 OhmGo. All rights reserved.</p>
  </footer>

  <button id="backToTopBtn" title="Go to top">↑ Top</button>

  <script>
    /* ------------- CONFIG: set this before publishing ------------- */
    // Replace with your actual repo raw base URL:
    // Format: https://raw.githubusercontent.com/USERNAME/REPO/BRANCH/images/
    const GITHUB_RAW_BASE = "https://raw.githubusercontent.com/ohmgoelectronics-cmd/ohmgo/main/images/";
    /* ------------------------------------------------------------- */

    // Example product list (edit/add as needed)
    const uniqueComponents = [
      "Arduino UNO R3","Arduino Mega 2560","Arduino Nano","Arduino Leonardo","Arduino Micro",
      "ESP32 Dev Board","ESP8266 NodeMCU","Raspberry Pi 4 Model B","Raspberry Pi 3 Model B+","Raspberry Pi Zero W"
    ];

    const componentPrices = {
      "Arduino UNO R3": 575,
      "Arduino Mega 2560": 950,
      "Arduino Nano": 250,
      "Arduino Leonardo": 550,
      "Arduino Micro": 500,
      "ESP32 Dev Board": 350,
      "ESP8266 NodeMCU": 300,
      "Raspberry Pi 4 Model B": 4899,
      "Raspberry Pi 3 Model B+": 3999,
      "Raspberry Pi Zero W": 700
    };

    // Map product names to expected image file names in your repo's images/ folder
    // Edit these filenames to match files you upload to GitHub (case-sensitive on raw URLs)
    const imageFileNameMap = {
      "Arduino UNO R3": "Arduino_UNO_R3.jpg",
      "Arduino Mega 2560": "Arduino_Mega_2560.jpg",
      "Arduino Nano": "Arduino_Nano.jpg",
      "Arduino Leonardo": "Arduino_Leonardo.jpg",
      "Arduino Micro": "Arduino_Micro.jpg",
      "ESP32 Dev Board": "ESP32_Dev_Board.jpg",
      "ESP8266 NodeMCU": "ESP8266_NodeMCU.jpg",
      "Raspberry Pi 4 Model B": "Raspberry_Pi_4_Model_B.jpg",
      "Raspberry Pi 3 Model B+": "Raspberry_Pi_3_Model_B+.jpg",
      "Raspberry Pi Zero W": "Raspberry_Pi_Zero_W.jpg"
    };

    // Load image overrides from repo-coded object (empty here) OR localStorage saved overrides
    // imageOverrides contains explicit absolute URLs (e.g. from Imgur/Cloudinary)
    let imageOverrides = {}; // default empty; will be populated from localStorage if present

    // Products array built from names, price and image URL
    const products = uniqueComponents.map(name => {
      const price = componentPrices[name] || 50;
      const fileName = imageFileNameMap[name] || null;
      // default image URL pointing to your GitHub raw files, fallback to placeholder
      const defaultImage = fileName ? (GITHUB_RAW_BASE + fileName) : (`https://via.placeholder.com/150?text=${encodeURIComponent(name)}`);
      return { name, price, image: defaultImage };
    });

    /* ------------------ Persistence (local overrides) ------------------ */
    const OVERRIDES_LS_KEY = "ohmgo_image_overrides_v1";
    function loadOverridesFromLocalStorage(){
      try {
        const raw = localStorage.getItem(OVERRIDES_LS_KEY);
        if (raw) {
          const obj = JSON.parse(raw);
          if (obj && typeof obj === "object") {
            imageOverrides = obj;
          }
        }
      } catch(e) { console.warn("Could not parse overrides", e); }
    }
    function saveOverridesToLocalStorage(){
      localStorage.setItem(OVERRIDES_LS_KEY, JSON.stringify(imageOverrides));
    }

    // apply overrides to products array
    function applyOverrides(){
      products.forEach(p => {
        if (imageOverrides[p.name]) {
          p.image = imageOverrides[p.name];
        } else {
          // ensure default from file name is used if override not present
          const fn = imageFileNameMap[p.name];
          p.image = fn ? (GITHUB_RAW_BASE + fn) : (`https://via.placeholder.com/150?text=${encodeURIComponent(p.name)}`);
        }
      });
    }

    // initial load
    loadOverridesFromLocalStorage();
    applyOverrides();

    /* ------------------ UI: Display Products ------------------ */
    const initialDisplayCount = 1000; // show all by default
    function displayProducts(list) {
      const container = document.getElementById("product-container");
      container.innerHTML = "";
      const toShow = list.slice(0, initialDisplayCount);
      toShow.forEach(product => {
        const card = document.createElement("div");
        card.className = "product-card";

        // create image element — add alt / error fallback
        const img = document.createElement("img");
        img.src = product.image;
        img.alt = product.name;
        img.title = "Click to change image URL";
        img.addEventListener("click", () => promptReplaceImageUrl(product.name));
        img.onerror = () => {
          // If image fails to load (404), show a placeholder
          img.src = `https://via.placeholder.com/150?text=${encodeURIComponent(product.name)}`;
        };

        const h3 = document.createElement("h3");
        h3.textContent = product.name;

        const p = document.createElement("p");
        p.textContent = `Price: ₹${product.price}`;

        const addBtn = document.createElement("button");
        addBtn.textContent = "Add to Cart";
        addBtn.onclick = () => addToCart(product.name);

        const replaceBtn = document.createElement("button");
        replaceBtn.textContent = "Replace Image (URL)";
        replaceBtn.className = "small";
        replaceBtn.onclick = () => promptReplaceImageUrl(product.name);

        const removeOverrideBtn = document.createElement("button");
        removeOverrideBtn.textContent = "Remove Override";
        removeOverrideBtn.className = "small";
        removeOverrideBtn.style.background = "#6c757d";
        removeOverrideBtn.style.marginTop = "6px";
        removeOverrideBtn.onclick = () => {
          if (imageOverrides[product.name]) {
            delete imageOverrides[product.name];
            saveOverridesToLocalStorage();
            applyOverrides();
            displayProducts(products);
            alert("Override removed locally. To make permanent for all users, update the repo images or commit exported overrides to your repo.");
          } else {
            alert("No override set for this product.");
          }
        };

        card.appendChild(img);
        card.appendChild(h3);
        card.appendChild(p);
        card.appendChild(addBtn);
        card.appendChild(replaceBtn);
        card.appendChild(removeOverrideBtn);

        container.appendChild(card);
      });
    }

    /* ------------- Replace image via URL (admin override) ------------- */
    function promptReplaceImageUrl(name) {
      const current = imageOverrides[name] || (imageFileNameMap[name] ? (GITHUB_RAW_BASE + imageFileNameMap[name]) : "");
      const url = prompt(`Enter a PUBLIC image URL for ${name}.\nExample: https://i.imgur.com/abcd123.jpg\n\nNOTE: This will store the override in your browser (localStorage). To make it permanent for everyone, use Export Overrides and commit JSON to your repo.`, current);
      if (!url) return;
      const trimmed = url.trim();
      if (!/^https?:\/\//i.test(trimmed)) {
        alert("Please enter a valid HTTP/HTTPS image URL.");
        return;
      }
      // set override and persist
      imageOverrides[name] = trimmed;
      saveOverridesToLocalStorage();
      applyOverrides();
      displayProducts(products);
      alert("Image override saved locally. Use 'Export Overrides' to download a JSON to commit to your repo if you want it permanent site-wide.");
    }

    /* ------------------ Add new product (optional image URL) ------------------ */
    const addProductBtn = document.getElementById("addProductBtn");
    addProductBtn.addEventListener("click", () => {
      const nameInput = document.getElementById("newProductName");
      const priceInput = document.getElementById("newProductPrice");
      const imageInput = document.getElementById("newProductImageUrl");
      const name = nameInput.value.trim();
      const price = parseFloat(priceInput.value);
      const imageUrl = (imageInput.value || "").trim();

      if (!name) { alert("Please enter a product name."); return; }
      if (isNaN(price) || price <= 0) { alert("Please enter a valid price."); return; }
      const p = { name, price, image: imageUrl || (`https://via.placeholder.com/150?text=${encodeURIComponent(name)}`) };
      products.unshift(p);

      // Update product lists & optionally store override if imageUrl provided
      if (imageUrl) {
        imageOverrides[name] = imageUrl;
        saveOverridesToLocalStorage();
      }
      displayProducts(products);

      // clear form
      nameInput.value = ""; priceInput.value = ""; imageInput.value = "";
    });

    /* ------------------ Export overrides (download JSON) ------------------ */
    const exportBtn = document.getElementById("exportOverridesBtn");
    exportBtn.addEventListener("click", () => {
      // Prepare JSON of overrides only (so you can commit as mapping)
      const blob = new Blob([JSON.stringify(imageOverrides, null, 2)], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "ohmgo-image-overrides.json";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
      alert("Downloaded ohmgo-image-overrides.json — commit this to your repo (or paste edits into the code) to make overrides permanent for everyone.");
    });

    /* ------------------ CART logic ------------------ */
    let cart = [];
    function addToCart(name) {
      const p = products.find(x => x.name === name);
      if (p) {
        cart.push(p);
        updateCart();
      }
    }
    function removeFromCart(i) {
      cart.splice(i, 1);
      updateCart();
    }
    function updateCart() {
      const container = document.getElementById("cart-items");
      const totalEl = document.getElementById("total-price");
      container.innerHTML = "";
      if (cart.length === 0) {
        container.innerHTML = "<p class='muted'>Your cart is empty.</p>";
        totalEl.textContent = "";
        document.getElementById("continue-btn").style.display = "none";
        document.getElementById("cart-count").textContent = 0;
        return;
      }
      let total = 0;
      cart.forEach((item, i) => {
        total += item.price;
        const div = document.createElement("div");
        div.className = "cart-item";
        const span = document.createElement("span");
        span.textContent = `${item.name} - ₹${item.price}`;
        const btn = document.createElement("button");
        btn.textContent = "Remove";
        btn.onclick = () => removeFromCart(i);
        div.appendChild(span);
        div.appendChild(btn);
        container.appendChild(div);
      });
      totalEl.textContent = `Total: ₹${total}`;
      document.getElementById("continue-btn").style.display = "block";
      document.getElementById("cart-count").textContent = cart.length;
    }

    /* ------------------ WhatsApp Checkout ------------------ */
    function showWhatsAppCheckout(){ document.getElementById("whatsapp-checkout").style.display = "block"; }
    function checkoutWhatsApp(){
      if (cart.length === 0) return;
      let msg = "Hello, I want to buy these items:%0A";
      cart.forEach(item => {
        msg += `- ${item.name} : ₹${item.price}%0A`;
      });
      const total = cart.reduce((s, it) => s + it.price, 0);
      msg += `Total: ₹${total}`;
      const url = `https://wa.me/919010532390?text=${msg}`;
      window.open(url, "_blank");
    }

    /* ------------------ Search + back-to-top ------------------ */
    document.getElementById("search").addEventListener("input", function() {
      const val = this.value.toLowerCase();
      const filtered = products.filter(p => p.name.toLowerCase().includes(val));
      displayProducts(filtered.length ? filtered : products);
    });

    const topBtn = document.getElementById("backToTopBtn");
    window.addEventListener("scroll", () => {
      if (document.documentElement.scrollTop > 200 || document.body.scrollTop > 200) topBtn.style.display = "block";
      else topBtn.style.display = "none";
    });
    topBtn.addEventListener("click", () => window.scrollTo({ top: 0, behavior: "smooth" }));

    /* ------------------ Initial render ------------------ */
    displayProducts(products);
    updateCart();
  </script>
</body>
</html>
